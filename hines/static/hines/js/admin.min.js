!function(g){"use strict";g(document).ready(function(){hines.admin.markdownEditor().init()}),window.hines=window.hines||{},window.hines.admin=window.hines.admin||{},window.hines.admin.markdownEditor=function(){var e=[{selector:"body.app-weblogs.model-post.change-form #id_intro",elementId:"id_intro",autosaveId:"weblogs-post-intro",buttons:"minimal",minHeight:"100px"},{selector:"body.app-weblogs.model-post.change-form #id_body",elementId:"id_body",autosaveId:"weblogs-post-body",buttons:"full",minHeight:"300px"}],t=["2","3"];function n(e){e.toTextArea()}function a(e){var t,i,n,a,o,l,r;t="<cite>",i="</cite>",/editor-preview-active/.test((e=e).codemirror.getWrapperElement().lastChild.className)||(i=void 0===i?t:i,n=e.codemirror,e.getState(n),e=t,o=i,l=n.getCursor("start"),r=n.getCursor("end"),a=(a=(a=n.getSelection()).split(t).join("")).split(i).join(""),n.replaceSelection(e+a+o),l.ch+=t.length,r.ch=l.ch+a.length,n.setSelection(l,r),n.focus())}function o(e){u(e,'<figure class="figure figure--blockquote">\n  <blockquote>\n    <p>',"    </p>\n  </blockquote>\n  <figcaption></figcaption>\n</figure>")}function l(e){i(e,"left")}function r(e){i(e,"standard")}function c(e){i(e,"full")}function s(e){i(e,"right")}function f(e){m(e,"full")}function i(e,t){var i='<figure class="figure figure--img';-1<["left","right","full"].indexOf(t)&&(i+=" figure--"+t);u(e,i+='">\n  <a href="" title="See on Flickr"><img src="','" alt=""></a>\n  <figcaption></figcaption>\n</figure>')}function m(e,t){var i,n,a,o,l='<figure class="figure figure--embed',t=(-1<["left","right"].indexOf(t)&&(l+=" figure--"+t),l+='">\n  <div class="figure--embed__16by9">\n    <iframe src="https://www.youtube-nocookie.com/embed/',e.codemirror.getSelection());t.startsWith("http")&&(t=function(e){{var t,i;0<=e.search(/youtube.com\/watch/)?(t=new URL(e.trim()),i=t.searchParams.get("v"),t=t.searchParams.get("t"),i&&(e="https://www.youtube.com/embed/"+i,t&&(e+="?start="+t))):0<=e.search(/\/\/vimeo.com/)&&(1<(i=e.match(/vimeo.com\/(\w+)$/)).length&&(e="https://player.vimeo.com/video/"+i[1]))}return e}(t),t=t,i=(i=e).codemirror,n={},a={},Object.assign(n,i.getCursor("start")),Object.assign(a,i.getCursor("end")),o=i.getSelection(),i.replaceSelection(t),a.ch+=t.length-o.length,i.setSelection(n,a),i.focus()),u(e,l,'" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>\n  </div>\n  <figcaption><a href="">on YouTube</a></figcaption>\n</figure>')}function u(e,t,i){var n,a,o,e=e.codemirror,l=e.getCursor("start"),r=e.getCursor("end"),c=l.line+1,s=r.line+1,l=l.line!==r.line,f=i;l&&s++,l&&0===r.ch&&(f=i+"\n",s--),l=!1,r=[t,f],/editor-preview-active/.test((i=e).getWrapperElement().lastChild.className)||(t=r[0],r=r[1],f={},o={},Object.assign(f,i.getCursor("start")),Object.assign(o,i.getCursor("end")),n&&(r=r.replace("#url#",n)),l?(a=i.getLine(f.line),t=a.slice(0,f.ch),r=a.slice(f.ch),i.replaceRange(t+r,{line:f.line,ch:0})):(a=i.getSelection(),i.replaceSelection(t+a+r),f.ch+=t.length,f!==o&&(o.ch+=t.length)),i.setSelection(f,o),i.focus()),e.setSelection({line:c,ch:0},{line:s,ch:0})}return{init:function(){0<=t.indexOf(g("#id_html_format").val())&&g.each(e,function(e,t){var i;0<g(t.selector).length&&(t=t,i={element:document.getElementById(t.elementId),autoDownloadFontAwesome:!0,indentWithTabs:!1,promptURLs:!0,minHeight:t.minHeight},"minimal"==t.buttons?i.toolbar=[{name:"textArea",action:n,className:"fa fa-times",title:"Revert to TextArea"},"|","bold","italic",{name:"cite",action:a,className:"fa fa-angle-double-left",title:"Cite"},"link","|","preview","side-by-side","fullscreen"]:"full"==t.buttons&&(i.toolbar=[{name:"textArea",action:n,className:"fa fa-times",title:"Revert to TextArea"},"|","bold","italic",{name:"cite",action:a,className:"fa fa-angle-double-left",title:"Cite"},"link","|","heading","code",{name:"quote-with-caption",action:o,className:"fa fa-quote-left",title:"Quote with caption"},"|",{name:"image-left",action:l,className:"fa fa-arrow-left",title:"Image, aligned left"},{name:"image-standard",action:r,className:"fa fa-picture-o",title:"Image, standard"},{name:"image-full",action:c,className:"fa fa-arrows-h",title:"Image, full-width"},{name:"image-right",action:s,className:"fa fa-arrow-right",title:"Image, aligned right"},"|",{name:"video-full",action:f,className:"fa fa-play",title:"Video, full-width"},"|","preview","side-by-side","fullscreen"]),new EasyMDE(i))})}}}}(django.jQuery);