!function(g){"use strict";g(document).ready(function(){hines.admin.markdownEditor().init()}),window.hines=window.hines||{},window.hines.admin=window.hines.admin||{},window.hines.admin.markdownEditor=function(){var e=[{selector:"body.app-weblogs.model-post.change-form #id_intro",elementId:"id_intro",autosaveId:"weblogs-post-intro",buttons:"minimal",minHeight:"100px"},{selector:"body.app-weblogs.model-post.change-form #id_body",elementId:"id_body",autosaveId:"weblogs-post-body",buttons:"full",minHeight:"300px"}],t=["2","3"];function i(e){e.toTextArea()}function n(e){var t,i,n,a,o,l,r;i="<cite>",n="</cite>",/editor-preview-active/.test((t=e).codemirror.getWrapperElement().lastChild.className)||(n=void 0===n?i:n,a=t.codemirror,t.getState(a),o=i,l=n,r=a.getCursor("start"),e=a.getCursor("end"),t=(t=(t=a.getSelection()).split(i).join("")).split(n).join(""),a.replaceSelection(o+t+l),r.ch+=i.length,e.ch=r.ch+t.length,a.setSelection(r,e),a.focus())}function a(e){m(e,'<figure class="figure figure--blockquote">\n  <blockquote>\n    <p>',"    </p>\n  </blockquote>\n  <figcaption></figcaption>\n</figure>")}function o(e){f(e,"left")}function l(e){f(e,"standard")}function r(e){f(e,"full")}function c(e){f(e,"right")}function s(e){u(e,"full")}function f(e,t){var i='<figure class="figure figure--img';-1<["left","right","full"].indexOf(t)&&(i+=" figure--"+t);m(e,i+='">\n  <a href="" title="See on Flickr"><img src="','" alt=""></a>\n  <figcaption></figcaption>\n</figure>')}function u(e,t){var i='<figure class="figure figure--embed';-1<["left","right"].indexOf(t)&&(i+=" figure--"+t),i+='">\n  <div class="figure--embed__16by9">\n    <iframe src="https://www.youtube-nocookie.com/embed/';t=e.codemirror.getSelection();t.startsWith("http")&&function(e,t){var i=e.codemirror,n={},a={};Object.assign(n,i.getCursor("start")),Object.assign(a,i.getCursor("end"));e=i.getSelection();i.replaceSelection(t),a.ch+=t.length-e.length,i.setSelection(n,a),i.focus()}(e,function(e){{var t,i;0<=e.search(/youtube.com\/watch/)?(i=new URL(e.trim()),t=i.searchParams.get("v"),i=i.searchParams.get("t"),t&&(e="https://www.youtube.com/embed/"+t,i&&(e+="?start="+i))):0<=e.search(/\/\/vimeo.com/)&&(1<(i=e.match(/vimeo.com\/(\w+)$/)).length&&(e="https://player.vimeo.com/video/"+i[1]))}return e}(t)),m(e,i,'" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>\n  </div>\n  <figcaption><a href="">on YouTube</a></figcaption>\n</figure>')}function m(e,t,i){var n,a,o=e.codemirror,l=o.getCursor("start"),r=o.getCursor("end"),c=l.line+1,s=r.line+1,f=l.line!==r.line,e=i;f&&s++,f&&0===r.ch&&(e=i+"\n",s--),l=!1,f=[t,e],/editor-preview-active/.test((r=o).getWrapperElement().lastChild.className)||(i=f[0],t=f[1],e={},f={},Object.assign(e,r.getCursor("start")),Object.assign(f,r.getCursor("end")),n&&(t=t.replace("#url#",n)),l?(a=r.getLine(e.line),i=a.slice(0,e.ch),t=a.slice(e.ch),r.replaceRange(i+t,{line:e.line,ch:0})):(a=r.getSelection(),r.replaceSelection(i+a+t),e.ch+=i.length,e!==f&&(f.ch+=i.length)),r.setSelection(e,f),r.focus()),o.setSelection({line:c,ch:0},{line:s,ch:0})}return{init:function(){0<=t.indexOf(g("#id_html_format").val())&&g.each(e,function(e,t){0<g(t.selector).length&&function(e){var t={element:document.getElementById(e.elementId),autoDownloadFontAwesome:!0,indentWithTabs:!1,promptURLs:!0,minHeight:e.minHeight};"minimal"==e.buttons?t.toolbar=[{name:"textArea",action:i,className:"fa fa-times",title:"Revert to TextArea"},"|","bold","italic",{name:"cite",action:n,className:"fa fa-angle-double-left",title:"Cite"},"link","|","preview","side-by-side","fullscreen"]:"full"==e.buttons&&(t.toolbar=[{name:"textArea",action:i,className:"fa fa-times",title:"Revert to TextArea"},"|","bold","italic",{name:"cite",action:n,className:"fa fa-angle-double-left",title:"Cite"},"link","|","heading","code",{name:"quote-with-caption",action:a,className:"fa fa-quote-left",title:"Quote with caption"},"|",{name:"image-left",action:o,className:"fa fa-arrow-left",title:"Image, aligned left"},{name:"image-standard",action:l,className:"fa fa-picture-o",title:"Image, standard"},{name:"image-full",action:r,className:"fa fa-arrows-h",title:"Image, full-width"},{name:"image-right",action:c,className:"fa fa-arrow-right",title:"Image, aligned right"},"|",{name:"video-full",action:s,className:"fa fa-play",title:"Video, full-width"},"|","preview","side-by-side","fullscreen"]);new EasyMDE(t)}(t)})}}}}(django.jQuery);