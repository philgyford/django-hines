!function(g){"use strict";g(document).ready(function(){hines.admin.markdownEditor().init()}),window.hines=window.hines||{},window.hines.admin=window.hines.admin||{},window.hines.admin.markdownEditor=function(){var e=[{selector:"body.app-weblogs.model-post.change-form #id_intro",elementId:"id_intro",autosaveId:"weblogs-post-intro",buttons:"minimal",minHeight:"100px"},{selector:"body.app-weblogs.model-post.change-form #id_body",elementId:"id_body",autosaveId:"weblogs-post-body",buttons:"full",minHeight:"300px"}],t=["2","3"];function i(e){e.toTextArea(),e=null}function n(e){!function(e,t,i){if(/editor-preview-active/.test(e.codemirror.getWrapperElement().lastChild.className))return;i=void 0===i?t:i;var n,a=e.codemirror,o=(e.getState(a),t),l=i,r=a.getCursor("start"),c=a.getCursor("end");n=(n=(n=a.getSelection()).split(t).join("")).split(i).join(""),a.replaceSelection(o+n+l),r.ch+=t.length,c.ch=r.ch+n.length,a.setSelection(r,c),a.focus()}(e,"<cite>","</cite>")}function a(e){m(e,'<figure class="figure figure--blockquote">\n  <blockquote>\n    <p>',"    </p>\n  </blockquote>\n  <figcaption></figcaption>\n</figure>")}function o(e){f(e,"left")}function l(e){f(e,"standard")}function r(e){f(e,"full")}function c(e){f(e,"right")}function s(e){u(e,"full")}function f(e,t){var i='<figure class="figure figure--img';-1<["left","right","full"].indexOf(t)&&(i+=" figure--"+t);m(e,i+='">\n  <a href="" title="See on Flickr"><img src="','" alt=""></a>\n  <figcaption></figcaption>\n</figure>')}function u(e,t){var i='<figure class="figure figure--embed';-1<["left","right"].indexOf(t)&&(i+=" figure--"+t),i+='">\n  <div class="figure--embed__16by9">\n    <iframe src="https://www.youtube-nocookie.com/embed/';var n=e.codemirror.getSelection();n.startsWith("http")&&function(e,t){var i=e.codemirror,n={},a={};Object.assign(n,i.getCursor("start")),Object.assign(a,i.getCursor("end"));var o=i.getSelection();i.replaceSelection(t),a.ch+=t.length-o.length,i.setSelection(n,a),i.focus()}(e,function(e){{var t,i,n,a;0<=e.search(/youtube.com\/watch/)?(t=new URL(e.trim()),i=t.searchParams.get("v"),n=t.searchParams.get("t"),i&&(e="https://www.youtube.com/embed/"+i,n&&(e+="?start="+n))):0<=e.search(/\/\/vimeo.com/)&&(1<(a=e.match(/vimeo.com\/(\w+)$/)).length&&(e="https://player.vimeo.com/video/"+a[1]))}return e}(n)),m(e,i,'" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>\n  </div>\n  <figcaption><a href="">on YouTube</a></figcaption>\n</figure>')}function m(e,t,i){var n=e.codemirror,a=n.getCursor("start"),o=n.getCursor("end"),l=a.line+1,r=o.line+1,c=a.line!==o.line,s=i;c&&r++,c&&0===o.ch&&(s=i+"\n",r--),function(e,t,i,n){if(/editor-preview-active/.test(e.getWrapperElement().lastChild.className))return;var a,o=i[0],l=i[1],r={},c={};Object.assign(r,e.getCursor("start")),Object.assign(c,e.getCursor("end")),n&&(l=l.replace("#url#",n));t?(a=e.getLine(r.line),o=a.slice(0,r.ch),l=a.slice(r.ch),e.replaceRange(o+l,{line:r.line,ch:0})):(a=e.getSelection(),e.replaceSelection(o+a+l),r.ch+=o.length,r!==c&&(c.ch+=o.length));e.setSelection(r,c),e.focus()}(n,!1,[t,s]),n.setSelection({line:l,ch:0},{line:r,ch:0})}return{init:function(){0<=t.indexOf(g("#id_html_format").val())&&g.each(e,function(e,t){0<g(t.selector).length&&function(e){var t={element:document.getElementById(e.elementId),autoDownloadFontAwesome:!0,indentWithTabs:!1,promptURLs:!0,minHeight:e.minHeight};"minimal"==e.buttons?t.toolbar=[{name:"textArea",action:i,className:"fa fa-times",title:"Revert to TextArea"},"|","bold","italic",{name:"cite",action:n,className:"fa fa-angle-double-left",title:"Cite"},"link","|","preview","side-by-side","fullscreen"]:"full"==e.buttons&&(t.toolbar=[{name:"textArea",action:i,className:"fa fa-times",title:"Revert to TextArea"},"|","bold","italic",{name:"cite",action:n,className:"fa fa-angle-double-left",title:"Cite"},"link","|","heading","code",{name:"quote-with-caption",action:a,className:"fa fa-quote-left",title:"Quote with caption"},"|",{name:"image-left",action:o,className:"fa fa-arrow-left",title:"Image, aligned left"},{name:"image-standard",action:l,className:"fa fa-picture-o",title:"Image, standard"},{name:"image-full",action:r,className:"fa fa-arrows-h",title:"Image, full-width"},{name:"image-right",action:c,className:"fa fa-arrow-right",title:"Image, aligned right"},"|",{name:"video-full",action:s,className:"fa fa-play",title:"Video, full-width"},"|","preview","side-by-side","fullscreen"]);new EasyMDE(t)}(t)})}}}}(django.jQuery);