!function(e){"use strict";e(document).ready(function(){hines.admin.markdownEditor().init()}),window.hines=window.hines||{},window.hines.admin=window.hines.admin||{},window.hines.admin.markdownEditor=function(){function t(e,t){var n='<figure class="figure figure--img';["left","right","full"].indexOf(t)>-1&&(n+=" figure--"+t);i(e,n+='">\n  <img src="','" alt="">\n  <figcaption></figcaption>\n</figure>')}function n(e,t){var n='<figure class="figure figure--embed';["left","right"].indexOf(t)>-1&&(n+=" figure--"+t),n+='">\n  <div class="figure--embed__16by9">\n    <iframe src="';var a=e.codemirror.getSelection();if(a.startsWith("http")){!function(e,t){var n=e.codemirror,i={},a={};Object.assign(i,n.getCursor("start")),Object.assign(a,n.getCursor("end"));var r=n.getSelection();n.replaceSelection(t),a.ch+=t.length-r.length,n.setSelection(i,a),n.focus()}(e,function(e){if(e.search(/youtube.com\/watch/)>=0){var t=new URL(e.trim()),n=t.searchParams.get("v"),i=t.searchParams.get("t");n&&(e="https://www.youtube.com/embed/"+n,i&&(e+="?start="+i))}else if(e.search(/\/\/vimeo.com/)>=0){var a=e.match(/vimeo.com\/(\w+)$/);a.length>1&&(e="https://player.vimeo.com/video/"+a[1])}return e}(a))}i(e,n,'" allowfullscreen></iframe>\n    <figcaption></figcaption>\n  </div>\n</figure>')}function i(e,t,n){var i=e.codemirror,a=i.getCursor("start"),r=i.getCursor("end"),o=a.line+1,s=r.line+1,l=a.line!==r.line,c=t,u=n;l&&s++,l&&0===r.ch&&(u=n+"\n",s--),function(e,t,n,i){if(/editor-preview-active/.test(e.getWrapperElement().lastChild.className))return;var a,r=n[0],o=n[1],s={},l={};Object.assign(s,e.getCursor("start")),Object.assign(l,e.getCursor("end")),i&&(o=o.replace("#url#",i));t?(a=e.getLine(s.line),r=a.slice(0,s.ch),o=a.slice(s.ch),e.replaceRange(r+o,{line:s.line,ch:0})):(a=e.getSelection(),e.replaceSelection(r+a+o),s.ch+=r.length,s!==l&&(l.ch+=r.length));e.setSelection(s,l),e.focus()}(i,!1,[c,u]),i.setSelection({line:o,ch:0},{line:s,ch:0})}var a=[{selector:"body.app-weblogs.model-post.change-form #id_intro",elementId:"id_intro",autosaveId:"weblogs-post-intro",buttons:"minimal"},{selector:"body.app-weblogs.model-post.change-form #id_body",elementId:"id_body",autosaveId:"weblogs-post-body",buttons:"full"}];return{init:function(){e.each(a,function(a,r){e(r.selector).length>0&&function(e){var a={element:document.getElementById(e.elementId),autoDownloadFontAwesome:!0,autosave:{enabled:!0,uniqueId:function(e){var t=e.autosaveId,n=function(){var e=window.location.href.split("/"),t=e.length;return"change"==e[t-2]?e[t-3]:null}();return null!==n&&(t+="-"+n),t}(e),delay:12e4},indentWithTabs:!1,promptURLs:!0};"minimal"==e.buttons?a.toolbar=["bold","italic","link","|","preview","side-by-side","fullscreen"]:"full"==e.buttons&&(a.toolbar=["bold","italic","strikethrough","heading","link","|","code",{name:"quote-with-caption",action:function(e){i(e,'<figure class="figure figure--blockquote">\n  <blockquote>\n    <p>',"    </p>\n  </blockquote>\n  <figcaption></figcaption>\n</figure>")},className:"fa fa-quote-left",title:"Quote with caption"},"unordered-list","ordered-list","horizontal-rule","|",{name:"image-left",action:function(e){t(e,"left")},className:"fa fa-arrow-left",title:"Image, aligned left"},{name:"image-standard",action:function(e){t(e,"standard")},className:"fa fa-picture-o",title:"Image, standard"},{name:"image-full",action:function(e){t(e,"full")},className:"fa fa-arrows-h",title:"Image, full-width"},{name:"image-right",action:function(e){t(e,"right")},className:"fa fa-arrow-right",title:"Image, aligned right"},"|",{name:"video-left",action:function(e){n(e,"left")},className:"fa fa-backward",title:"Video, aligned left"},{name:"video-full",action:function(e){n(e,"full")},className:"fa fa-play",title:"Video, full-width"},{name:"video-right",action:function(e){n(e,"right")},className:"fa fa-forward",title:"Video, aligned right"},"|","preview","side-by-side","fullscreen"]),new InscrybMDE(a)}(r)})}}}}(django.jQuery),function(e){"use strict";e(document).ready(function(){hines.admin.patternsField().init()}),window.hines=window.hines||{},window.hines.admin=window.hines.admin||{},window.hines.admin.patternsField=function(){return{init:function(){0!==e(".js-patterns").length&&e(".js-patterns").each(function(t){!function(t){!function(e){e.before('        <div style="margin-bottom: 0.5em;">          <span style="white-space:nowrap">            Video:             &nbsp;             <a href="#" class="js-patterns-button" data-pattern="video" data-options="left">Left</a> &nbsp;            <a href="#" class="js-patterns-button" data-pattern="video">Full</a> &nbsp;            <a href="#" class="js-patterns-button" data-pattern="video" data-options="right">Right</a> &nbsp;            •             &nbsp;           </span>          <span style="white-space:nowrap">            Image:             &nbsp;             <a href="#" class="js-patterns-button" data-pattern="img" data-options="left">Left</a> &nbsp;            <a href="#" class="js-patterns-button" data-pattern="img" data-options="">Standard</a> &nbsp;            <a href="#" class="js-patterns-button" data-pattern="img" data-options="full">Full</a> &nbsp;            <a href="#" class="js-patterns-button" data-pattern="img" data-options="right">Right</a> &nbsp;            •             &nbsp;           </span>          <span style="white-space:nowrap">            <a href="#" class="js-patterns-button" data-pattern="quote">Quote</a> &nbsp;            •             &nbsp;             <a href="#" class="js-patterns-button" data-pattern="code">Code</a> &nbsp;          </span>        </div>      ')}(t),e(".js-patterns-button").on("click",function(t){t.preventDefault();var n=e(this).parent().parent().siblings(".js-patterns"),i=e(this).data("pattern"),a=e(this).data("options");!function(e,t,n){var i=e.val(),a=e.prop("selectionStart"),r=e.prop("selectionEnd"),o=i.substr(0,a),s=i.substr(a,r-a),l=i.substr(r),c="";t&&(c=function(e,t,n){var i=function(e){var t="";return"video"===e?t='<figure class="figure figure--embed">\n  <div class="figure--embed__16by9">\n    <iframe src="" allowfullscreen></iframe>\n    <figcaption></figcaption>\n  </div>\n</figure>':"img"===e?t='<figure class="figure figure--img">\n  <img src="" alt="">\n  <figcaption></figcaption>\n</figure>':"quote"===e?t='<figure class="figure figure--blockquote">\n  <blockquote>\n    <p></p>\n  </blockquote>\n  <figcaption></figcaption>\n</figure>':"code"===e&&(t="<pre><code></code></pre>"),t}(e);if("video"===e){if(n.includes("left")?i=i.replace('--embed"','--embed figure--left"'):n.includes("right")&&(i=i.replace('--embed"','--embed figure--right"')),t&&t.trim().startsWith("http")){var a=function(e){if(e.search(/youtube.com\/watch/)>=0){var t=new URL(e.trim()),n=t.searchParams.get("v"),i=t.searchParams.get("t");n&&(e="https://www.youtube.com/embed/"+n,i&&(e+="?start="+i))}else if(e.search(/\/\/vimeo.com/)>=0){var a=e.match(/vimeo.com\/(\w+)$/);a.length>1&&(e="https://player.vimeo.com/video/"+a[1])}return e}(t);i=i.replace('""','"'+a+'"')}}else"img"===e?(n.includes("left")?i=i.replace('--img"','--img figure--left"'):n.includes("full")?i=i.replace('--img"','--img figure--full"'):n.includes("right")&&(i=i.replace('--img"','--img figure--right"')),t&&t.trim().startsWith("http")&&(i=i.replace('src=""','src="'+t.trim()+'"'))):"quote"===e?(t=t.trim().replace(/\n\n/g,"</p>\n    <p>"),i=i.replace("<p></p>","<p>"+t+"</p>")):"code"===e&&(t=t.trim().replace(/\n\n/g,"</p>\n    <p>"),i=i.replace("<code></code>","<code>"+t+"</code>"));return i}(t,s,[n])),i=o+c+l,e.val(i)}(n,i,a)})}(e(this))})}}}}(django.jQuery);